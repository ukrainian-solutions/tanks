$(function() {
  var add_boost, callback, create_map, draw_tank, lock, move_tank, my_direction, my_go, my_tank, remove_boost, show_tabl_tank, start_game, stop;
  stop = true;
  my_direction = 'up';
  my_go = false;
  my_tank = false;
  lock = false;
  callback = function() {
    return lock = false;
  };
  setTimeout(callback, 3000);
  create_map = function(map) {
    var div, x, y, _i, _j, _ref, _ref1, _results;
    div = $('<div/>', {
      id: 'box',
      text: 'I am box'
    });
    _results = [];
    for (x = _i = 0, _ref = map.length - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; x = 0 <= _ref ? ++_i : --_i) {
      for (y = _j = 0, _ref1 = map[x].length; 0 <= _ref1 ? _j <= _ref1 : _j >= _ref1; y = 0 <= _ref1 ? ++_j : --_j) {
        if (map[x][y] === 0) {
          $('<div/>', {
            id: 'box',
            'class': 'box',
            'data-x': x,
            'data-y': y
          }).appendTo('body');
          continue;
        }
        if (map[x][y] === 1) {
          $('<div/>', {
            id: 'box',
            'class': 'box wall',
            'data-x': x,
            'data-y': y
          }).appendTo('body');
          continue;
        }
        if (map[x][y] === 3) {
          $('<div/>', {
            id: 'box',
            'class': 'box grass',
            'data-x': x,
            'data-y': y
          }).appendTo('body');
        }
        if (map[x][y] === 4) {
          $('<div/>', {
            id: 'box',
            'class': 'box water',
            'data-x': x,
            'data-y': y
          }).appendTo('body');
        }
      }
      _results.push($('<div/>', {
        id: 'nbox',
        'style': 'clear: both;'
      }).appendTo('body'));
    }
    return _results;
  };
  start_game = function() {
    return socket.emit('addTank', function(tank_json) {
      if (tank_json["id"] === void 0) {
        my_tank = new Tank(tank_json);
        tank_json = {
          "id": tank_json[0],
          "direction": tank_json[1],
          "is_hold": tank_json[2],
          "wait": tank_json[3],
          "bullets": tank_json[4],
          "bullets_max": tank_json[5],
          "health": tank_json[6],
          "place_on_map": tank_json[7]
        };
      }
      console.log('this is tank', tank_json);
      return draw_tank(tank_json);
    });
  };
  start_game();
  draw_tank = function(tank_json) {
    var div, x, y;
    if (tank_json["id"] === void 0) {
      tank_json = {
        "id": tank_json[0],
        "direction": tank_json[1],
        "is_hold": tank_json[2],
        "wait": tank_json[3],
        "bullets": tank_json[4],
        "bullets_max": tank_json[5],
        "health": tank_json[6],
        "place_on_map": tank_json[7]
      };
    }
    y = tank_json['place_on_map'][0];
    x = tank_json['place_on_map'][1];
    div = $('*[data-x=' + x.toString() + '][data-y=' + y.toString() + ']');
    div.attr('data-id_tank', tank_json['id']);
    div.html(tank_json['health']);
    if (tank_json['id'] === my_tank.id) {
      div.addClass('my_tank');
    } else {
      div.addClass('tank');
    }
    return div.addClass(tank_json['direction']);
  };
  move_tank = function(tank_json) {
    var tank;
    if (tank_json["id"] === void 0) {
      tank_json = {
        "id": tank_json[0],
        "direction": tank_json[1],
        "is_hold": tank_json[2],
        "wait": tank_json[3],
        "bullets": tank_json[4],
        "bullets_max": tank_json[5],
        "health": tank_json[6],
        "place_on_map": tank_json[7]
      };
    }
    tank = $('[data-id_tank=' + tank_json['id'] + ']');
    tank.html('');
    if (tank_json['id'] === my_tank.id) {
      tank.removeClass('my_tank');
    } else {
      tank.removeClass('tank');
    }
    tank.removeClass('left');
    tank.removeClass('right');
    tank.removeClass('down');
    tank.removeClass('up');
    tank.addClass('box');
    return draw_tank(tank_json);
  };
  show_tabl_tank = function(tank_json) {
    var div, tank, td_damage_inflicted, td_demage_obtained, td_health, td_id;
    tank = '#t_' + tank_json['id'];
    console.log('call show tabl_tank', tank, $(tank));
    if ($(tank).length > 0) {
      console.log('not tank tr');
      div = $('<tr/>', {
        id: tank,
        'class': 'tr_tank'
      }).appendTo('.stats');
      td_id = $('<td/>', {
        id: '_id',
        'class': 'td_tank'
      }).appendTo(div);
      td_health = $('<td/>', {
        id: 'health',
        'class': 'td_tank'
      }).appendTo(div);
      td_damage_inflicted = $('<td/>', {
        id: 'damage_inflicted',
        'class': 'td_tank'
      }).appendTo(div);
      td_demage_obtained = $('<td/>', {
        id: 'demage_obtained',
        'class': 'td_tank'
      }).appendTo(div);
    } else {
      console.log('yes tank tr');
      td_id = $(tank + ' #_id');
      td_health = $(tank + ' #health');
      td_damage_inflicted = $(tank(+' #damage_inflicted'));
      td_demage_obtained = $(tank(' #demage_obtained'));
    }
    td_id.html(tank_json['id']);
    td_health.html(tank_json['health'] > 0 ? tank_json['health'] : 0);
    td_damage_inflicted.html(tank_json['damage_inflicted'] > 0 ? tank_json['damage_inflicted'] : 0);
    return td_demage_obtained.html(tank_json['demage_obtained'] > 0 ? tank_json['demage_obtained'] : 0);
  };
  socket.on('tankDestroy', function(tank_id) {
    var tank;
    tank = $('[data-id_tank=' + tank_id + ']');
    tank.html('');
    if (tank_id === my_tank.id) {
      tank.removeClass('my_tank');
    } else {
      tank.removeClass('tank');
    }
    tank.removeClass('left');
    tank.removeClass('right');
    tank.removeClass('down');
    tank.removeClass('up');
    return tank.addClass('box');
  });
  add_boost = function(boost) {
    var div, x, y;
    y = boost[0][0];
    x = boost[0][1];
    div = $('*[data-x=' + x.toString() + '][data-y=' + y.toString() + ']');
    return div.addClass(boost[1]);
  };
  remove_boost = function(boost) {
    var div, x, y;
    y = boost[0][0];
    x = boost[0][1];
    div = $('*[data-x=' + x.toString() + '][data-y=' + y.toString() + ']');
    return div.removeClass(boost[1]);
  };
  socket.on('newBoost', function(boost) {
    console.log('boost', boost);
    return add_boost(boost);
  });
  socket.on('removeBoost', function(boost) {
    console.log('boost', boost);
    return remove_boost(boost);
  });
  $('html').keydown(function(eventObject) {
    var go, now_direct;
    now_direct = my_direction;
    go = my_go;
    if (event.keyCode === 37) {
      console.log("Ура нажали left");
      now_direct = 'left';
    }
    if (event.keyCode === 38) {
      console.log("Ура нажали up");
      now_direct = 'up';
    }
    if (event.keyCode === 39) {
      console.log("Ура нажали right");
      now_direct = 'right';
    }
    if (event.keyCode === 40) {
      console.log("Ура нажали down");
      now_direct = 'down';
    }
    if (event.keyCode === 81) {
      console.log('Ура нажали го');
      go = false;
    }
    if (event.keyCode === 87) {
      console.log('Ура нажали stop');
      go = true;
    }
    return socket.emit('setDirection', now_direct, go);
  });
  socket.on('tanks', function(tanks) {
    var tank, _i, _len, _results;
    _results = [];
    for (_i = 0, _len = tanks.length; _i < _len; _i++) {
      tank = tanks[_i];
      _results.push(move_tank(tank));
    }
    return _results;
  });
  socket.on('info', function(logg) {
    return console.log(logg);
  });
  socket.emit('map', function(map) {
    return create_map(map);
  });
  return socket.emit('tanks', function(tanks_json) {
    var tank, _i, _len, _results;
    _results = [];
    for (_i = 0, _len = tanks_json.length; _i < _len; _i++) {
      tank = tanks_json[_i];
      _results.push(draw_tank(tank));
    }
    return _results;
  });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL21hcF9jcmVhdGUuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLENBQUEsQ0FBRSxTQUFBLEdBQUE7QUFDQSxNQUFBLHlJQUFBO0FBQUEsRUFBQSxJQUFBLEdBQU8sSUFBUCxDQUFBO0FBQUEsRUFDQSxZQUFBLEdBQWUsSUFEZixDQUFBO0FBQUEsRUFFQSxLQUFBLEdBQVEsS0FGUixDQUFBO0FBQUEsRUFHQSxPQUFBLEdBQVUsS0FIVixDQUFBO0FBQUEsRUFJQSxJQUFBLEdBQU8sS0FKUCxDQUFBO0FBQUEsRUFLQSxRQUFBLEdBQVcsU0FBQSxHQUFBO1dBQ1QsSUFBQSxHQUFPLE1BREU7RUFBQSxDQUxYLENBQUE7QUFBQSxFQU9BLFVBQUEsQ0FBVyxRQUFYLEVBQXFCLElBQXJCLENBUEEsQ0FBQTtBQUFBLEVBUUEsVUFBQSxHQUFhLFNBQUMsR0FBRCxHQUFBO0FBQ1gsUUFBQSx3Q0FBQTtBQUFBLElBQUEsR0FBQSxHQUFNLENBQUEsQ0FBRSxRQUFGLEVBQVk7QUFBQSxNQUNoQixFQUFBLEVBQUksS0FEWTtBQUFBLE1BRWhCLElBQUEsRUFBTSxVQUZVO0tBQVosQ0FBTixDQUFBO0FBSUE7U0FBUyxtR0FBVCxHQUFBO0FBQ0UsV0FBUyx1R0FBVCxHQUFBO0FBQ0UsUUFBQSxJQUFHLEdBQUksQ0FBQSxDQUFBLENBQUcsQ0FBQSxDQUFBLENBQVAsS0FBYSxDQUFoQjtBQUNFLFVBQUEsQ0FBQSxDQUFFLFFBQUYsRUFBWTtBQUFBLFlBQ1YsRUFBQSxFQUFJLEtBRE07QUFBQSxZQUVWLE9BQUEsRUFBUyxLQUZDO0FBQUEsWUFHVixRQUFBLEVBQVUsQ0FIQTtBQUFBLFlBSVYsUUFBQSxFQUFVLENBSkE7V0FBWixDQUtFLENBQUMsUUFMSCxDQUtZLE1BTFosQ0FBQSxDQUFBO0FBTUEsbUJBUEY7U0FBQTtBQVFBLFFBQUEsSUFBRyxHQUFJLENBQUEsQ0FBQSxDQUFHLENBQUEsQ0FBQSxDQUFQLEtBQWEsQ0FBaEI7QUFDRSxVQUFBLENBQUEsQ0FB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QUEsRUFrUEEsTUFBTSxDQUFDLEVBQVAsQ0FBVSxNQUFWLEVBQWtCLFNBQUMsSUFBRCxHQUFBO1dBQ2hCLE9BQU8sQ0FBQyxHQUFSLENBQVksSUFBWixFQURnQjtFQUFBLENBQWxCLENBbFBBLENBQUE7QUFBQSxFQXNQQSxNQUFNLENBQUMsSUFBUCxDQUFZLEtBQVosRUFBbUIsU0FBQyxHQUFELEdBQUE7V0FDakIsVUFBQSxDQUFXLEdBQVgsRUFEaUI7RUFBQSxDQUFuQixDQXRQQSxDQUFBO1NBMFBBLE1BQU0sQ0FBQyxJQUFQLENBQVksT0FBWixFQUFxQixTQUFDLFVBQUQsR0FBQTtBQUNuQixRQUFBLHdCQUFBO0FBQUE7U0FBQSxpREFBQTs0QkFBQTtBQUNFLG9CQUFBLFNBQUEsQ0FBVSxJQUFWLEVBQUEsQ0FERjtBQUFBO29CQURtQjtFQUFBLENBQXJCLEVBM1BBO0FBQUEsQ0FBRixDQUFBLENBQUEiLCJmaWxlIjoianMvbWFwX2NyZWF0ZS5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbIiQgLT5cbiAgc3RvcCA9IHRydWVcbiAgbXlfZGlyZWN0aW9uID0gJ3VwJ1xuICBteV9nbyA9IGZhbHNlXG4gIG15X3RhbmsgPSBmYWxzZVxuICBsb2NrID0gZmFsc2VcbiAgY2FsbGJhY2sgPSAtPlxuICAgIGxvY2sgPSBmYWxzZVxuICBzZXRUaW1lb3V0IGNhbGxiYWNrLCAzMDAwXG4gIGNyZWF0ZV9tYXAgPSAobWFwKSAtPlxuICAgIGRpdiA9ICQoJzxkaXYvPicsIHtcbiAgICAgIGlkOiAnYm94JyxcbiAgICAgIHRleHQ6ICdJIGFtIGJveCdcbiAgICB9KVxuICAgIGZvciB4IGluIFswLi5tYXAubGVuZ3RoLTFdXG4gICAgICBmb3IgeSBpbiBbMC4ubWFwW3hdLmxlbmd0aF1cbiAgICAgICAgaWYgbWFwW3hdW3ldID09IDBcbiAgICAgICAgICAkKCc8ZGl2Lz4nLCB7XG4gICAgICAgICAgICBpZDogJ2JveCcsXG4gICAgICAgICAgICAnY2xhc3MnOiAnYm94JyxcbiAgICAgICAgICAgICdkYXRhLXgnOiB4LFxuICAgICAgICAgICAgJ2RhdGEteSc6IHlcbiAgICAgICAgICB9KS5hcHBlbmRUbyAnYm9keSdcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICBpZihtYXBbeF1beV0gPT0gMSlcbiAgICAgICAgICAkKCc8ZGl2Lz4nLCB7XG4gICAgICAgICAgICBpZDogJ2JveCcsXG4gICAgICAgICAgICAnY2xhc3MnOiAnYm94IHdhbGwnLFxuICAgICAgICAgICAgJ2RhdGEteCc6IHgsXG4gICAgICAgICAgICAnZGF0YS15JzogeVxuICAgICAgICAgIH0pLmFwcGVuZFRvKCdib2R5JylcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICBpZihtYXBbeF1beV0gPT0gMylcbiAgICAgICAgICAkKCc8ZGl2Lz4nLCB7XG4gICAgICAgICAgICBpZDogJ2JveCcsXG4gICAgICAgICAgICAnY2xhc3MnOiAnYm94IGdyYXNzJyxcbiAgICAgICAgICAgICdkYXRhLXgnOiB4LFxuICAgICAgICAgICAgJ2RhdGEteSc6IHlcbiAgICAgICAgICB9KS5hcHBlbmRUbyAnYm9keSdcblxuICAgICAgICBpZihtYXBbeF1beV0gPT0gNClcbiAgICAgICAgICAkKCc8ZGl2Lz4nLCB7XG4gICAgICAgICAgICBpZDogJ2JveCcsXG4gICAgICAgICAgICAnY2xhc3MnOiAnYm94IHdhdGVyJyxcbiAgICAgICAgICAgICdkYXRhLXgnOiB4LFxuICAgICAgICAgICAgJ2RhdGEteSc6IHlcbiAgICAgICAgICB9KS5hcHBlbmRUbyAnYm9keSdcbiAgICAgICQoJzxkaXYvPicsIHtcbiAgICAgICAgaWQ6ICduYm94JyxcbiAgICAgICAgJ3N0eWxlJzogJ2NsZWFyOiBib3RoOydcbiAgICAgIH0pLmFwcGVuZFRvICdib2R5J1xuXG4gIHN0YXJ0X2dhbWUgPSAgKCktPlxuICAgIHNvY2tldC5lbWl0KCdhZGRUYW5rJywgKHRhbmtfanNvbikgLT5cbiAgICAgIGlmIHRhbmtfanNvbltcImlkXCJdID09IHVuZGVmaW5lZFxuICAgICAgICBteV90YW5rID0gbmV3IFRhbmsodGFua19qc29uKVxuICAgICAgICB0YW5rX2pzb24gPVxuICAgICAgICAgIFwiaWRcIjogdGFua19qc29uWzBdLFxuICAgICAgICAgIFwiZGlyZWN0aW9uXCI6IHRhbmtfanNvblsxXSxcbiAgICAgICAgICBcImlzX2hvbGRcIjogdGFua19qc29uWzJdLFxuICAgICAgICAgIFwid2FpdFwiOiB0YW5rX2pzb25bM10sXG4gICAgICAgICAgXCJidWxsZXRzXCI6IHRhbmtfanNvbls0XSxcbiAgICAgICAgICBcImJ1bGxldHNfbWF4XCI6IHRhbmtfanNvbls1XSxcbiAgICAgICAgICBcImhlYWx0aFwiOiB0YW5rX2pzb25bNl0sXG4gICAgICAgICAgXCJwbGFjZV9vbl9tYXBcIjogdGFua19qc29uWzddXG5cbiAgICAgIGNvbnNvbGUubG9nKCd0aGlzIGlzIHRhbmsnLCB0YW5rX2pzb24pO1xuICAgICAgZHJhd190YW5rKHRhbmtfanNvbilcbiAgICAgIClcblxuICBzdGFydF9nYW1lKClcblxuICBkcmF3X3RhbmsgPSAodGFua19qc29uKSAtPlxuICAgICMgcmV0dXJuIFtAaWQsIEBkaXJlY3Rpb24sIEBpc19ob2xkLCBAd2FpdCwgQGJ1bGxldHMsIEBidWxsZXRzX21heCwgQGhlYWx0aCwgQHBsYWNlX29uX21hcF1cbiAgICBpZih0YW5rX2pzb25bXCJpZFwiXSA9PSB1bmRlZmluZWQpXG4gICAgICB0YW5rX2pzb24gPVxuICAgICAgICBcImlkXCI6IHRhbmtfanNvblswXSxcbiAgICAgICAgXCJkaXJlY3Rpb25cIjogdGFua19qc29uWzFdLFxuICAgICAgICBcImlzX2hvbGRcIjogdGFua19qc29uWzJdLFxuICAgICAgICBcIndhaXRcIjogdGFua19qc29uWzNdLFxuICAgICAgICBcImJ1bGxldHNcIjogdGFua19qc29uWzRdLFxuICAgICAgICBcImJ1bGxldHNfbWF4XCI6IHRhbmtfanNvbls1XSxcbiAgICAgICAgXCJoZWFsdGhcIjogdGFua19qc29uWzZdLFxuICAgICAgICBcInBsYWNlX29uX21hcFwiOiB0YW5rX2pzb25bN11cblxuICAgIHkgPSB0YW5rX2pzb25bJ3BsYWNlX29uX21hcCddWzBdXG4gICAgeCA9IHRhbmtfanNvblsncGxhY2Vfb25fbWFwJ11bMV1cbiAgICBkaXYgPSAkKCcqW2RhdGEteD0nK3gudG9TdHJpbmcoKSsnXVtkYXRhLXk9JysgeS50b1N0cmluZygpKyddJylcbiAgICBkaXYuYXR0cignZGF0YS1pZF90YW5rJywgdGFua19qc29uWydpZCddKVxuICAgIGRpdi5odG1sKHRhbmtfanNvblsnaGVhbHRoJ10pXG4gICAgaWYodGFua19qc29uWydpZCddID09IG15X3RhbmsuaWQpXG4gICAgICAgIGRpdi5hZGRDbGFzcygnbXlfdGFuaycpXG4gICAgZWxzZVxuICAgICAgICBkaXYuYWRkQ2xhc3MoJ3RhbmsnKVxuICAgIGRpdi5hZGRDbGFzcyh0YW5rX2pzb25bJ2RpcmVjdGlvbiddKVxuXG4gIG1vdmVfdGFuayA9ICh0YW5rX2pzb24pIC0+XG4gICAgIy8vIHRvSnNvbjogLT4gW0BpZFxuICAgICMgICAgICAgICAgICAvLyBAZGlyZWN0aW9uXG4gICAgIyAgICAgICAgICAgIC8vIEBpc19ob2xkXG4gICAgIyAgICAgICAgICAgIC8vIEB3YWl0XG4gICAgIyAgICAgICAgICAgIC8vIEBidWxsZXRzXG4gICAgIyAgICAgICAgICAgIC8vIEBidWxsZXRzX21heFxuICAgICMgICAgICAgICAgICAvLyBAaGVhbHRoXG4gICAgIyAgICAgICAgICAgIC8vIEBwbGFjZV9vbl9tYXBcbiAgICAjICAgICAgICAgICAgLy8gQGRhbWFnZV9pbmZsaWN0ZWRcbiAgICAjICAgICAgICAgICAgLy8gQGRlbWFnZV9vYnRhaW5lZFxuICAgICMgICAgICAgICAgICAvLyBAZGVzdHJveWVkXVxuICAgIGlmKHRhbmtfanNvbltcImlkXCJdID09IHVuZGVmaW5lZClcbiAgICAgIHRhbmtfanNvbiA9XG4gICAgICAgIFwiaWRcIjogdGFua19qc29uWzBdLFxuICAgICAgICBcImRpcmVjdGlvblwiOiB0YW5rX2pzb25bMV0sXG4gICAgICAgIFwiaXNfaG9sZFwiOiB0YW5rX2pzb25bMl0sXG4gICAgICAgIFwid2FpdFwiOiB0YW5rX2pzb25bM10sXG4gICAgICAgIFwiYnVsbGV0c1wiOiB0YW5rX2pzb25bNF0sXG4gICAgICAgIFwiYnVsbGV0c19tYXhcIjogdGFua19qc29uWzVdLFxuICAgICAgICBcImhlYWx0aFwiOiB0YW5rX2pzb25bNl0sXG4gICAgICAgIFwicGxhY2Vfb25fbWFwXCI6IHRhbmtfanNvbls3XVxuICAgIHRhbmsgPSAkKCdbZGF0YS1pZF90YW5rPScrdGFua19qc29uWydpZCddKyddJylcbiAgICB0YW5rLmh0bWwoJycpXG4gICAgaWYgdGFua19qc29uWydpZCddID09IG15X3RhbmsuaWRcbiAgICAgICAgdGFuay5yZW1vdmVDbGFzcygnbXlfdGFuaycpXG4gICAgZWxzZVxuICAgICAgICB0YW5rLnJlbW92ZUNsYXNzKCd0YW5rJylcbiAgICB0YW5rLnJlbW92ZUNsYXNzKCdsZWZ0JylcbiAgICB0YW5rLnJlbW92ZUNsYXNzKCdyaWdodCcpXG4gICAgdGFuay5yZW1vdmVDbGFzcygnZG93bicpXG4gICAgdGFuay5yZW1vdmVDbGFzcygndXAnKVxuICAgIHRhbmsuYWRkQ2xhc3MoJ2JveCcpXG4gICAgZHJhd190YW5rKHRhbmtfanNvbilcblxuICBzaG93X3RhYmxfdGFuayA9ICh0YW5rX2pzb24pIC0+XG4gICAgdGFuayA9ICcjdF8nK3RhbmtfanNvblsnaWQnXVxuICAgIGNvbnNvbGUubG9nKCdjYWxsIHNob3cgdGFibF90YW5rJywgdGFuaywgJCh0YW5rKSlcbiAgICBpZiAkKHRhbmspLmxlbmd0aCA+IDBcbiAgICAgIGNvbnNvbGUubG9nKCdub3QgdGFuayB0cicpXG4gICAgICBkaXYgPSAkKCc8dHIvPicsIHtcbiAgICAgICAgaWQ6IHRhbmssXG4gICAgICAgICdjbGFzcyc6ICd0cl90YW5rJyxcbiAgICAgIH0pLmFwcGVuZFRvICcuc3RhdHMnXG4gICAgICB0ZF9pZCA9ICQoJzx0ZC8+Jywge1xuICAgICAgICBpZDogJ19pZCcsXG4gICAgICAgICdjbGFzcyc6ICd0ZF90YW5rJyxcbiAgICAgIH0pLmFwcGVuZFRvIGRpdlxuICAgICAgdGRfaGVhbHRoID0gJCgnPHRkLz4nLCB7XG4gICAgICAgIGlkOiAnaGVhbHRoJyxcbiAgICAgICAgJ2NsYXNzJzogJ3RkX3RhbmsnLFxuICAgICAgfSkuYXBwZW5kVG8gZGl2XG4gICAgICB0ZF9kYW1hZ2VfaW5mbGljdGVkID0gJCgnPHRkLz4nLCB7XG4gICAgICAgIGlkOiAnZGFtYWdlX2luZmxpY3RlZCcsXG4gICAgICAgICdjbGFzcyc6ICd0ZF90YW5rJyxcbiAgICAgIH0pLmFwcGVuZFRvIGRpdlxuICAgICAgdGRfZGVtYWdlX29idGFpbmVkID0gJCgnPHRkLz4nLCB7XG4gICAgICAgIGlkOiAnZGVtYWdlX29idGFpbmVkJyxcbiAgICAgICAgJ2NsYXNzJzogJ3RkX3RhbmsnLFxuICAgICAgfSkuYXBwZW5kVG8gZGl2XG5cbiAgICBlbHNlXG4gICAgICBjb25zb2xlLmxvZyAneWVzIHRhbmsgdHInXG4gICAgICB0ZF9pZCA9ICQodGFuaysnICNfaWQnKVxuICAgICAgdGRfaGVhbHRoID0gJCh0YW5rKycgI2hlYWx0aCcpXG4gICAgICB0ZF9kYW1hZ2VfaW5mbGljdGVkID0gJCh0YW5rICsnICNkYW1hZ2VfaW5mbGljdGVkJylcbiAgICAgIHRkX2RlbWFnZV9vYnRhaW5lZCA9ICQodGFuayAnICNkZW1hZ2Vfb2J0YWluZWQnKVxuXG4gICAgdGRfaWQuaHRtbCh0YW5rX2pzb25bJ2lkJ10pXG4gICAgdGRfaGVhbHRoLmh0bWwoaWYgdGFua19qc29uWydoZWFsdGgnXSA+IDAgdGhlbiB0YW5rX2pzb25bJ2hlYWx0aCddIGVsc2UgMClcbiAgICB0ZF9kYW1hZ2VfaW5mbGljdGVkLmh0bWwoaWYgdGFua19qc29uWydkYW1hZ2VfaW5mbGljdGVkJ10gPiAwIHRoZW4gdGFua19qc29uWydkYW1hZ2VfaW5mbGljdGVkJ10gZWxzZSAwKVxuICAgIHRkX2RlbWFnZV9vYnRhaW5lZC5odG1sKGlmIHRhbmtfanNvblsnZGVtYWdlX29idGFpbmVkJ10gPiAwIHRoZW4gdGFua19qc29uWydkZW1hZ2Vfb2J0YWluZWQnXSAgZWxzZSAwKVxuXG5cbiAgc29ja2V0Lm9uKCd0YW5rRGVzdHJveScsICh0YW5rX2lkKSAtPlxuICAgIHRhbmsgPSAkKCdbZGF0YS1pZF90YW5rPScrdGFua19pZCsnXScpXG4gICAgdGFuay5odG1sKCcnKVxuICAgIGlmIHRhbmtfaWQgPT0gbXlfdGFuay5pZFxuICAgICAgICB0YW5rLnJlbW92ZUNsYXNzKCdteV90YW5rJylcbiAgICBlbHNlXG4gICAgICAgIHRhbmsucmVtb3ZlQ2xhc3MoJ3RhbmsnKVxuICAgIHRhbmsucmVtb3ZlQ2xhc3MoJ2xlZnQnKVxuICAgIHRhbmsucmVtb3ZlQ2xhc3MoJ3JpZ2h0JylcbiAgICB0YW5rLnJlbW92ZUNsYXNzKCdkb3duJylcbiAgICB0YW5rLnJlbW92ZUNsYXNzKCd1cCcpXG4gICAgdGFuay5hZGRDbGFzcygnYm94JylcbiAgKVxuXG4gIGFkZF9ib29zdCA9IChib29zdCkgLT5cbiAgICB5ID0gYm9vc3RbMF1bMF1cbiAgICB4ID0gYm9vc3RbMF1bMV1cblxuICAgIGRpdiA9ICQoJypbZGF0YS14PScreC50b1N0cmluZygpKyddW2RhdGEteT0nKyB5LnRvU3RyaW5nKCkrJ10nKVxuICAgIGRpdi5hZGRDbGFzcyhib29zdFsxXSlcblxuICByZW1vdmVfYm9vc3QgPSAoYm9vc3QpIC0+XG4gICAgeSA9IGJvb3N0WzBdWzBdXG4gICAgeCA9IGJvb3N0WzBdWzFdXG5cbiAgICBkaXYgPSAkKCcqW2RhdGEteD0nK3gudG9TdHJpbmcoKSsnXVtkYXRhLXk9JysgeS50b1N0cmluZygpKyddJylcbiAgICBkaXYucmVtb3ZlQ2xhc3MoYm9vc3RbMV0pXG5cbiAgc29ja2V0Lm9uKCduZXdCb29zdCcsIChib29zdCkgLT5cbiAgICBjb25zb2xlLmxvZygnYm9vc3QnLGJvb3N0KVxuICAgIGFkZF9ib29zdChib29zdClcbiAgKVxuICBzb2NrZXQub24oJ3JlbW92ZUJvb3N0JywgKGJvb3N0KSAtPlxuICAgIGNvbnNvbGUubG9nKCdib29zdCcsYm9vc3QpXG4gICAgcmVtb3ZlX2Jvb3N0KGJvb3N0KVxuICApXG5cbiAgJCgnaHRtbCcpLmtleWRvd24oIChldmVudE9iamVjdCkgLT5cbiAgICBub3dfZGlyZWN0ID0gbXlfZGlyZWN0aW9uXG4gICAgZ28gPSBteV9nb1xuICAgIGlmIChldmVudC5rZXlDb2RlID09IDM3KVxuICAgICAgICBjb25zb2xlLmxvZyhcItCj0YDQsCDQvdCw0LbQsNC70LggbGVmdFwiKVxuICAgICAgICBub3dfZGlyZWN0ID0gJ2xlZnQnXG5cbiAgICBpZiAoZXZlbnQua2V5Q29kZSA9PSAzOClcbiAgICAgICAgY29uc29sZS5sb2coXCLQo9GA0LAg0L3QsNC20LDQu9C4IHVwXCIpXG4gICAgICAgIG5vd19kaXJlY3QgPSAndXAnXG5cbiAgICBpZiAoZXZlbnQua2V5Q29kZSA9PSAzOSlcbiAgICAgICAgY29uc29sZS5sb2coXCLQo9GA0LAg0L3QsNC20LDQu9C4IHJpZ2h0XCIpO1xuICAgICAgICBub3dfZGlyZWN0ID0gJ3JpZ2h0J1xuXG4gICAgaWYgKGV2ZW50LmtleUNvZGUgPT0gNDApXG4gICAgICAgIGNvbnNvbGUubG9nKFwi0KPRgNCwINC90LDQttCw0LvQuCBkb3duXCIpO1xuICAgICAgICBub3dfZGlyZWN0ID0gJ2Rvd24nXG5cbiAgICBpZiAoZXZlbnQua2V5Q29kZSA9PSA4MSlcbiAgICAgICAgY29uc29sZS5sb2coJ9Cj0YDQsCDQvdCw0LbQsNC70Lgg0LPQvicpO1xuICAgICAgICBnbyA9IGZhbHNlO1xuXG4gICAgaWYgKGV2ZW50LmtleUNvZGUgPT0gODcpXG4gICAgICAgIGNvbnNvbGUubG9nKCfQo9GA0LAg0L3QsNC20LDQu9C4IHN0b3AnKVxuICAgICAgICBnbyA9IHRydWVcblxuICAgIHNvY2tldC5lbWl0KCdzZXREaXJlY3Rpb24nLCBub3dfZGlyZWN0LCBnbylcbiAgICApXG5cbiAgc29ja2V0Lm9uKCd0YW5rcycsICh0YW5rcykgLT5cbiAgIyAgIC8vIGNvbnNvbGUubG9nKHRhbmtzWzFdLnBsYWNlX29uX21hcCk7XG4gICAgZm9yIHRhbmsgaW4gdGFua3NcbiAgICAgIG1vdmVfdGFuayh0YW5rKVxuICApXG5cbiAgc29ja2V0Lm9uKCdpbmZvJywgKGxvZ2cpIC0+XG4gICAgY29uc29sZS5sb2cobG9nZylcbiAgKVxuXG4gIHNvY2tldC5lbWl0KCdtYXAnLCAobWFwKSAtPlxuICAgIGNyZWF0ZV9tYXAobWFwKVxuICApXG5cbiAgc29ja2V0LmVtaXQoJ3RhbmtzJywgKHRhbmtzX2pzb24pIC0+XG4gICAgZm9yIHRhbmsgaW4gdGFua3NfanNvblxuICAgICAgZHJhd190YW5rKHRhbmspXG4gIClcbiJdfQ==