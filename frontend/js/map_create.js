$(function() {
  var add_boost, callback, create_map, draw_tank, lock, move_tank, my_direction, my_go, my_tank, remove_boost, show_tabl_tank, start, start_game, stop;
  start = false;
  stop = true;
  my_direction = 'up';
  my_go = false;
  my_tank = false;
  lock = false;
  callback = function() {
    return lock = false;
  };
  setTimeout(callback, 3000);
  create_map = function(map) {
    var div, x, y, _i, _j, _ref, _ref1, _results;
    div = $('<div/>', {
      id: 'box',
      text: 'I am box'
    });
    _results = [];
    for (x = _i = 0, _ref = map.length - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; x = 0 <= _ref ? ++_i : --_i) {
      for (y = _j = 0, _ref1 = map[x].length; 0 <= _ref1 ? _j <= _ref1 : _j >= _ref1; y = 0 <= _ref1 ? ++_j : --_j) {
        if (map[x][y] === 0) {
          $('<div/>', {
            id: 'box',
            'class': 'box',
            'data-x': x,
            'data-y': y
          }).appendTo('body');
          continue;
        }
        if (map[x][y] === 1) {
          $('<div/>', {
            id: 'box',
            'class': 'box wall',
            'data-x': x,
            'data-y': y
          }).appendTo('body');
          continue;
        }
        if (map[x][y] === 3) {
          $('<div/>', {
            id: 'box',
            'class': 'box grass',
            'data-x': x,
            'data-y': y
          }).appendTo('body');
        }
        if (map[x][y] === 4) {
          $('<div/>', {
            id: 'box',
            'class': 'box water',
            'data-x': x,
            'data-y': y
          }).appendTo('body');
        }
      }
      _results.push($('<div/>', {
        id: 'nbox',
        'style': 'clear: both;'
      }).appendTo('body'));
    }
    return _results;
  };
  start_game = function() {
    return socket.emit('addTank', function(tank_json) {
      if (tank_json["id"] === void 0) {
        my_tank = new Tank(tank_json);
        tank_json = {
          "id": tank_json[0],
          "direction": tank_json[1],
          "is_hold": tank_json[2],
          "wait": tank_json[3],
          "bullets": tank_json[4],
          "bullets_max": tank_json[5],
          "health": tank_json[6],
          "place_on_map": tank_json[7]
        };
      }
      console.log('this is tank', tank_json);
      return draw_tank(tank_json);
    });
  };
  start_game();
  draw_tank = function(tank_json) {
    var div, x, y;
    if (tank_json["id"] === void 0) {
      tank_json = {
        "id": tank_json[0],
        "direction": tank_json[1],
        "is_hold": tank_json[2],
        "wait": tank_json[3],
        "bullets": tank_json[4],
        "bullets_max": tank_json[5],
        "health": tank_json[6],
        "place_on_map": tank_json[7]
      };
    }
    y = tank_json['place_on_map'][0];
    x = tank_json['place_on_map'][1];
    div = $('*[data-x=' + x.toString() + '][data-y=' + y.toString() + ']');
    div.attr('data-id_tank', tank_json['id']);
    div.html(tank_json['health']);
    if (tank_json['id'] === my_tank.id) {
      div.addClass('my_tank');
    } else {
      div.addClass('tank');
    }
    return div.addClass(tank_json['direction']);
  };
  move_tank = function(tank_json) {
    var tank;
    if (tank_json["id"] === void 0) {
      tank_json = {
        "id": tank_json[0],
        "direction": tank_json[1],
        "is_hold": tank_json[2],
        "wait": tank_json[3],
        "bullets": tank_json[4],
        "bullets_max": tank_json[5],
        "health": tank_json[6],
        "place_on_map": tank_json[7]
      };
    }
    tank = $('[data-id_tank=' + tank_json['id'] + ']');
    tank.html('');
    if (tank_json['id'] === my_tank.id) {
      tank.removeClass('my_tank');
    } else {
      tank.removeClass('tank');
    }
    tank.removeClass('left');
    tank.removeClass('right');
    tank.removeClass('down');
    tank.removeClass('up');
    tank.addClass('box');
    return draw_tank(tank_json);
  };
  show_tabl_tank = function(tank_json) {
    var div, tank, td_damage_inflicted, td_demage_obtained, td_health, td_id;
    tank = '#t_' + tank_json['id'];
    console.log('call show tabl_tank', tank, $(tank));
    if ($(tank).length > 0) {
      console.log('not tank tr');
      div = $('<tr/>', {
        id: tank,
        'class': 'tr_tank'
      }).appendTo('.stats');
      td_id = $('<td/>', {
        id: '_id',
        'class': 'td_tank'
      }).appendTo(div);
      td_health = $('<td/>', {
        id: 'health',
        'class': 'td_tank'
      }).appendTo(div);
      td_damage_inflicted = $('<td/>', {
        id: 'damage_inflicted',
        'class': 'td_tank'
      }).appendTo(div);
      td_demage_obtained = $('<td/>', {
        id: 'demage_obtained',
        'class': 'td_tank'
      }).appendTo(div);
    } else {
      console.log('yes tank tr');
      td_id = $(tank + ' #_id');
      td_health = $(tank + ' #health');
      td_damage_inflicted = $(tank(+' #damage_inflicted'));
      td_demage_obtained = $(tank(' #demage_obtained'));
    }
    td_id.html(tank_json['id']);
    td_health.html(tank_json['health'] > 0 ? tank_json['health'] : 0);
    td_damage_inflicted.html(tank_json['damage_inflicted'] > 0 ? tank_json['damage_inflicted'] : 0);
    return td_demage_obtained.html(tank_json['demage_obtained'] > 0 ? tank_json['demage_obtained'] : 0);
  };
  socket.on('tankDestroy', function(tank_id) {
    var tank;
    tank = $('[data-id_tank=' + tank_id + ']');
    tank.html('');
    if (tank_id === my_tank.id) {
      tank.removeClass('my_tank');
    } else {
      tank.removeClass('tank');
    }
    tank.removeClass('left');
    tank.removeClass('right');
    tank.removeClass('down');
    tank.removeClass('up');
    return tank.addClass('box');
  });
  add_boost = function(boost) {
    var div, x, y;
    y = boost[0][0];
    x = boost[0][1];
    div = $('*[data-x=' + x.toString() + '][data-y=' + y.toString() + ']');
    return div.addClass(boost[1]);
  };
  remove_boost = function(boost) {
    var div, x, y;
    y = boost[0][0];
    x = boost[0][1];
    div = $('*[data-x=' + x.toString() + '][data-y=' + y.toString() + ']');
    return div.removeClass(boost[1]);
  };
  socket.on('newBoost', function(boost) {
    console.log('boost', boost);
    return add_boost(boost);
  });
  socket.on('removeBoost', function(boost) {
    console.log('boost', boost);
    return remove_boost(boost);
  });
  $('html').keydown(function(eventObject) {
    var go, now_direct;
    now_direct = my_direction;
    go = my_go;
    if (event.keyCode === 37) {
      console.log("Ура нажали left");
      now_direct = 'left';
    }
    if (event.keyCode === 38) {
      console.log("Ура нажали up");
      now_direct = 'up';
    }
    if (event.keyCode === 39) {
      console.log("Ура нажали right");
      now_direct = 'right';
    }
    if (event.keyCode === 40) {
      console.log("Ура нажали down");
      now_direct = 'down';
    }
    if (event.keyCode === 81) {
      console.log('Ура нажали го');
      go = false;
    }
    if (event.keyCode === 87) {
      console.log('Ура нажали stop');
      go = true;
    }
    return socket.emit('setDirection', now_direct, go);
  });
  socket.on('tanks', function(tanks) {
    var tank, _i, _len, _results;
    _results = [];
    for (_i = 0, _len = tanks.length; _i < _len; _i++) {
      tank = tanks[_i];
      _results.push(move_tank(tank));
    }
    return _results;
  });
  socket.on('info', function(logg) {
    return console.log(logg);
  });
  socket.emit('map', function(map) {
    return create_map(map);
  });
  socket.emit('tanks', function(tanks_json) {
    var tank, _i, _len, _results;
    _results = [];
    for (_i = 0, _len = tanks_json.length; _i < _len; _i++) {
      tank = tanks_json[_i];
      _results.push(draw_tank(tank));
    }
    return _results;
  });
  $('#start').bind('click', function() {
    if (!start) {
      console.log('start');
      socket.emit('start');
      return stop = false;
    }
  });
  return $('#stop').bind('click', function() {
    if (!stop) {
      console.log('stop');
      socket.emit('stop');
      return start = false;
    }
  });
});

//# sourceMappingURL=data:application/json;base64,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ImpzL21hcF9jcmVhdGUuanMiLCJzb3VyY2VSb290IjoiL3NvdXJjZS8iLCJzb3VyY2VzQ29udGVudCI6WyIkIC0+XG4gIHN0YXJ0ID0gZmFsc2VcbiAgc3RvcCA9IHRydWVcbiAgbXlfZGlyZWN0aW9uID0gJ3VwJ1xuICBteV9nbyA9IGZhbHNlXG4gIG15X3RhbmsgPSBmYWxzZVxuICBsb2NrID0gZmFsc2VcbiAgY2FsbGJhY2sgPSAtPlxuICAgIGxvY2sgPSBmYWxzZVxuICBzZXRUaW1lb3V0IGNhbGxiYWNrLCAzMDAwXG4gIGNyZWF0ZV9tYXAgPSAobWFwKSAtPlxuICAgIGRpdiA9ICQoJzxkaXYvPicsIHtcbiAgICBpZDogJ2JveCcsXG4gICAgdGV4dDogJ0kgYW0gYm94J1xuICAgIH0pXG4gICAgZm9yIHggaW4gWzAuLm1hcC5sZW5ndGgtMV1cbiAgICAgIGZvciB5IGluIFswLi5tYXBbeF0ubGVuZ3RoXVxuICAgICAgICBpZiBtYXBbeF1beV0gPT0gMFxuICAgICAgICAgICQoJzxkaXYvPicsIHtcbiAgICAgICAgICAgIGlkOiAnYm94JyxcbiAgICAgICAgICAgICdjbGFzcyc6ICdib3gnLFxuICAgICAgICAgICAgJ2RhdGEteCc6IHgsXG4gICAgICAgICAgICAnZGF0YS15JzogeVxuICAgICAgICAgIH0pLmFwcGVuZFRvICdib2R5J1xuICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIGlmKG1hcFt4XVt5XSA9PSAxKVxuICAgICAgICAgICQoJzxkaXYvPicsIHtcbiAgICAgICAgICAgIGlkOiAnYm94JyxcbiAgICAgICAgICAgICdjbGFzcyc6ICdib3ggd2FsbCcsXG4gICAgICAgICAgICAnZGF0YS14JzogeCxcbiAgICAgICAgICAgICdkYXRhLXknOiB5XG4gICAgICAgICAgfSkuYXBwZW5kVG8oJ2JvZHknKVxuICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIGlmKG1hcFt4XVt5XSA9PSAzKVxuICAgICAgICAgICQoJzxkaXYvPicsIHtcbiAgICAgICAgICAgIGlkOiAnYm94JyxcbiAgICAgICAgICAgICdjbGFzcyc6ICdib3ggZ3Jhc3MnLFxuICAgICAgICAgICAgJ2RhdGEteCc6IHgsXG4gICAgICAgICAgICAnZGF0YS15JzogeVxuICAgICAgICAgIH0pLmFwcGVuZFRvICdib2R5J1xuXG4gICAgICAgIGlmKG1hcFt4XVt5XSA9PSA0KVxuICAgICAgICAgICQoJzxkaXYvPicsIHtcbiAgICAgICAgICAgIGlkOiAnYm94JyxcbiAgICAgICAgICAgICdjbGFzcyc6ICdib3ggd2F0ZXInLFxuICAgICAgICAgICAgJ2RhdGEteCc6IHgsXG4gICAgICAgICAgICAnZGF0YS15JzogeVxuICAgICAgICAgIH0pLmFwcGVuZFRvICdib2R5J1xuICAgICAgJCgnPGRpdi8+Jywge1xuICAgICAgICBpZDogJ25ib3gnLFxuICAgICAgICAnc3R5bGUnOiAnY2xlYXI6IGJvdGg7J1xuICAgICAgfSkuYXBwZW5kVG8gJ2JvZHknXG5cbiAgc3RhcnRfZ2FtZSA9ICAoKS0+XG4gICAgc29ja2V0LmVtaXQoJ2FkZFRhbmsnLCAodGFua19qc29uKSAtPlxuICAgICAgaWYgdGFua19qc29uW1wiaWRcIl0gPT0gdW5kZWZpbmVkXG4gICAgICAgIG15X3RhbmsgPSBuZXcgVGFuayh0YW5rX2pzb24pXG4gICAgICAgIHRhbmtfanNvbiA9XG4gICAgICAgICAgXCJpZFwiOiB0YW5rX2pzb25bMF0sXG4gICAgICAgICAgXCJkaXJlY3Rpb25cIjogdGFua19qc29uWzFdLFxuICAgICAgICAgIFwiaXNfaG9sZFwiOiB0YW5rX2pzb25bMl0sXG4gICAgICAgICAgXCJ3YWl0XCI6IHRhbmtfanNvblszXSxcbiAgICAgICAgICBcImJ1bGxldHNcIjogdGFua19qc29uWzRdLFxuICAgICAgICAgIFwiYnVsbGV0c19tYXhcIjogdGFua19qc29uWzVdLFxuICAgICAgICAgIFwiaGVhbHRoXCI6IHRhbmtfanNvbls2XSxcbiAgICAgICAgICBcInBsYWNlX29uX21hcFwiOiB0YW5rX2pzb25bN11cblxuICAgICAgY29uc29sZS5sb2coJ3RoaXMgaXMgdGFuaycsIHRhbmtfanNvbik7XG4gICAgICBkcmF3X3RhbmsodGFua19qc29uKVxuICAgICAgKVxuXG4gIHN0YXJ0X2dhbWUoKVxuXG4gIGRyYXdfdGFuayA9ICh0YW5rX2pzb24pIC0+XG4gICAgIyByZXR1cm4gW0BpZCwgQGRpcmVjdGlvbiwgQGlzX2hvbGQsIEB3YWl0LCBAYnVsbGV0cywgQGJ1bGxldHNfbWF4LCBAaGVhbHRoLCBAcGxhY2Vfb25fbWFwXVxuICAgIGlmKHRhbmtfanNvbltcImlkXCJdID09IHVuZGVmaW5lZClcbiAgICAgIHRhbmtfanNvbiA9XG4gICAgICAgIFwiaWRcIjogdGFua19qc29uWzBdLFxuICAgICAgICBcImRpcmVjdGlvblwiOiB0YW5rX2pzb25bMV0sXG4gICAgICAgIFwiaXNfaG9sZFwiOiB0YW5rX2pzb25bMl0sXG4gICAgICAgIFwid2FpdFwiOiB0YW5rX2pzb25bM10sXG4gICAgICAgIFwiYnVsbGV0c1wiOiB0YW5rX2pzb25bNF0sXG4gICAgICAgIFwiYnVsbGV0c19tYXhcIjogdGFua19qc29uWzVdLFxuICAgICAgICBcImhlYWx0aFwiOiB0YW5rX2pzb25bNl0sXG4gICAgICAgIFwicGxhY2Vfb25fbWFwXCI6IHRhbmtfanNvbls3XVxuXG4gICAgeSA9IHRhbmtfanNvblsncGxhY2Vfb25fbWFwJ11bMF1cbiAgICB4ID0gdGFua19qc29uWydwbGFjZV9vbl9tYXAnXVsxXVxuICAgIGRpdiA9ICQoJypbZGF0YS14PScreC50b1N0cmluZygpKyddW2RhdGEteT0nKyB5LnRvU3RyaW5nKCkrJ10nKVxuICAgIGRpdi5hdHRyKCdkYXRhLWlkX3RhbmsnLCB0YW5rX2pzb25bJ2lkJ10pXG4gICAgZGl2Lmh0bWwodGFua19qc29uWydoZWFsdGgnXSlcbiAgICBpZih0YW5rX2pzb25bJ2lkJ10gPT0gbXlfdGFuay5pZClcbiAgICAgICAgZGl2LmFkZENsYXNzKCdteV90YW5rJylcbiAgICBlbHNlXG4gICAgICAgIGRpdi5hZGRDbGFzcygndGFuaycpXG4gICAgZGl2LmFkZENsYXNzKHRhbmtfanNvblsnZGlyZWN0aW9uJ10pXG5cbiAgbW92ZV90YW5rID0gKHRhbmtfanNvbikgLT5cbiAgICAjLy8gdG9Kc29uOiAtPiBbQGlkXG4gICAgIyAgICAgICAgICAgIC8vIEBkaXJlY3Rpb25cbiAgICAjICAgICAgICAgICAgLy8gQGlzX2hvbGRcbiAgICAjICAgICAgICAgICAgLy8gQHdhaXRcbiAgICAjICAgICAgICAgICAgLy8gQGJ1bGxldHNcbiAgICAjICAgICAgICAgICAgLy8gQGJ1bGxldHNfbWF4XG4gICAgIyAgICAgICAgICAgIC8vIEBoZWFsdGhcbiAgICAjICAgICAgICAgICAgLy8gQHBsYWNlX29uX21hcFxuICAgICMgICAgICAgICAgICAvLyBAZGFtYWdlX2luZmxpY3RlZFxuICAgICMgICAgICAgICAgICAvLyBAZGVtYWdlX29idGFpbmVkXG4gICAgIyAgICAgICAgICAgIC8vIEBkZXN0cm95ZWRdXG4gICAgaWYodGFua19qc29uW1wiaWRcIl0gPT0gdW5kZWZpbmVkKVxuICAgICAgdGFua19qc29uID1cbiAgICAgICAgXCJpZFwiOiB0YW5rX2pzb25bMF0sXG4gICAgICAgIFwiZGlyZWN0aW9uXCI6IHRhbmtfanNvblsxXSxcbiAgICAgICAgXCJpc19ob2xkXCI6IHRhbmtfanNvblsyXSxcbiAgICAgICAgXCJ3YWl0XCI6IHRhbmtfanNvblszXSxcbiAgICAgICAgXCJidWxsZXRzXCI6IHRhbmtfanNvbls0XSxcbiAgICAgICAgXCJidWxsZXRzX21heFwiOiB0YW5rX2pzb25bNV0sXG4gICAgICAgIFwiaGVhbHRoXCI6IHRhbmtfanNvbls2XSxcbiAgICAgICAgXCJwbGFjZV9vbl9tYXBcIjogdGFua19qc29uWzddXG4gICAgdGFuayA9ICQoJ1tkYXRhLWlkX3Rhbms9Jyt0YW5rX2pzb25bJ2lkJ10rJ10nKVxuICAgIHRhbmsuaHRtbCgnJylcbiAgICBpZiB0YW5rX2pzb25bJ2lkJ10gPT0gbXlfdGFuay5pZFxuICAgICAgICB0YW5rLnJlbW92ZUNsYXNzKCdteV90YW5rJylcbiAgICBlbHNlXG4gICAgICAgIHRhbmsucmVtb3ZlQ2xhc3MoJ3RhbmsnKVxuICAgIHRhbmsucmVtb3ZlQ2xhc3MoJ2xlZnQnKVxuICAgIHRhbmsucmVtb3ZlQ2xhc3MoJ3JpZ2h0JylcbiAgICB0YW5rLnJlbW92ZUNsYXNzKCdkb3duJylcbiAgICB0YW5rLnJlbW92ZUNsYXNzKCd1cCcpXG4gICAgdGFuay5hZGRDbGFzcygnYm94JylcbiAgICBkcmF3X3RhbmsodGFua19qc29uKVxuXG4gIHNob3dfdGFibF90YW5rID0gKHRhbmtfanNvbikgLT5cbiAgICB0YW5rID0gJyN0XycrdGFua19qc29uWydpZCddXG4gICAgY29uc29sZS5sb2coJ2NhbGwgc2hvdyB0YWJsX3RhbmsnLCB0YW5rLCAkKHRhbmspKVxuICAgIGlmICQodGFuaykubGVuZ3RoID4gMFxuICAgICAgY29uc29sZS5sb2coJ25vdCB0YW5rIHRyJylcbiAgICAgIGRpdiA9ICQoJzx0ci8+Jywge1xuICAgICAgICBpZDogdGFuayxcbiAgICAgICAgJ2NsYXNzJzogJ3RyX3RhbmsnLFxuICAgICAgfSkuYXBwZW5kVG8gJy5zdGF0cydcbiAgICAgIHRkX2lkID0gJCgnPHRkLz4nLCB7XG4gICAgICAgIGlkOiAnX2lkJyxcbiAgICAgICAgJ2NsYXNzJzogJ3RkX3RhbmsnLFxuICAgICAgfSkuYXBwZW5kVG8gZGl2XG4gICAgICB0ZF9oZWFsdGggPSAkKCc8dGQvPicsIHtcbiAgICAgICAgaWQ6ICdoZWFsdGgnLFxuICAgICAgICAnY2xhc3MnOiAndGRfdGFuaycsXG4gICAgICB9KS5hcHBlbmRUbyBkaXZcbiAgICAgIHRkX2RhbWFnZV9pbmZsaWN0ZWQgPSAkKCc8dGQvPicsIHtcbiAgICAgICAgaWQ6ICdkYW1hZ2VfaW5mbGljdGVkJyxcbiAgICAgICAgJ2NsYXNzJzogJ3RkX3RhbmsnLFxuICAgICAgfSkuYXBwZW5kVG8gZGl2XG4gICAgICB0ZF9kZW1hZ2Vfb2J0YWluZWQgPSAkKCc8dGQvPicsIHtcbiAgICAgICAgaWQ6ICdkZW1hZ2Vfb2J0YWluZWQnLFxuICAgICAgICAnY2xhc3MnOiAndGRfdGFuaycsXG4gICAgICB9KS5hcHBlbmRUbyBkaXZcblxuICAgIGVsc2VcbiAgICAgIGNvbnNvbGUubG9nICd5ZXMgdGFuayB0cidcbiAgICAgIHRkX2lkID0gJCh0YW5rKycgI19pZCcpXG4gICAgICB0ZF9oZWFsdGggPSAkKHRhbmsrJyAjaGVhbHRoJylcbiAgICAgIHRkX2RhbWFnZV9pbmZsaWN0ZWQgPSAkKHRhbmsgKycgI2RhbWFnZV9pbmZsaWN0ZWQnKVxuICAgICAgdGRfZGVtYWdlX29idGFpbmVkID0gJCh0YW5rICcgI2RlbWFnZV9vYnRhaW5lZCcpXG5cbiAgICB0ZF9pZC5odG1sKHRhbmtfanNvblsnaWQnXSlcbiAgICB0ZF9oZWFsdGguaHRtbChpZiB0YW5rX2pzb25bJ2hlYWx0aCddID4gMCB0aGVuIHRhbmtfanNvblsnaGVhbHRoJ10gZWxzZSAwKVxuICAgIHRkX2RhbWFnZV9pbmZsaWN0ZWQuaHRtbChpZiB0YW5rX2pzb25bJ2RhbWFnZV9pbmZsaWN0ZWQnXSA+IDAgdGhlbiB0YW5rX2pzb25bJ2RhbWFnZV9pbmZsaWN0ZWQnXSBlbHNlIDApXG4gICAgdGRfZGVtYWdlX29idGFpbmVkLmh0bWwoaWYgdGFua19qc29uWydkZW1hZ2Vfb2J0YWluZWQnXSA+IDAgdGhlbiB0YW5rX2pzb25bJ2RlbWFnZV9vYnRhaW5lZCddICBlbHNlIDApXG5cblxuICBzb2NrZXQub24oJ3RhbmtEZXN0cm95JywgKHRhbmtfaWQpIC0+XG4gICAgdGFuayA9ICQoJ1tkYXRhLWlkX3Rhbms9Jyt0YW5rX2lkKyddJylcbiAgICB0YW5rLmh0bWwoJycpXG4gICAgaWYgdGFua19pZCA9PSBteV90YW5rLmlkXG4gICAgICAgIHRhbmsucmVtb3ZlQ2xhc3MoJ215X3RhbmsnKVxuICAgIGVsc2VcbiAgICAgICAgdGFuay5yZW1vdmVDbGFzcygndGFuaycpXG4gICAgdGFuay5yZW1vdmVDbGFzcygnbGVmdCcpXG4gICAgdGFuay5yZW1vdmVDbGFzcygncmlnaHQnKVxuICAgIHRhbmsucmVtb3ZlQ2xhc3MoJ2Rvd24nKVxuICAgIHRhbmsucmVtb3ZlQ2xhc3MoJ3VwJylcbiAgICB0YW5rLmFkZENsYXNzKCdib3gnKVxuICApXG5cbiAgYWRkX2Jvb3N0ID0gKGJvb3N0KSAtPlxuICAgIHkgPSBib29zdFswXVswXVxuICAgIHggPSBib29zdFswXVsxXVxuXG4gICAgZGl2ID0gJCgnKltkYXRhLXg9Jyt4LnRvU3RyaW5nKCkrJ11bZGF0YS15PScrIHkudG9TdHJpbmcoKSsnXScpXG4gICAgZGl2LmFkZENsYXNzKGJvb3N0WzFdKVxuXG4gIHJlbW92ZV9ib29zdCA9IChib29zdCkgLT5cbiAgICB5ID0gYm9vc3RbMF1bMF1cbiAgICB4ID0gYm9vc3RbMF1bMV1cblxuICAgIGRpdiA9ICQoJypbZGF0YS14PScreC50b1N0cmluZygpKyddW2RhdGEteT0nKyB5LnRvU3RyaW5nKCkrJ10nKVxuICAgIGRpdi5yZW1vdmVDbGFzcyhib29zdFsxXSlcblxuICBzb2NrZXQub24oJ25ld0Jvb3N0JywgKGJvb3N0KSAtPlxuICAgIGNvbnNvbGUubG9nKCdib29zdCcsYm9vc3QpXG4gICAgYWRkX2Jvb3N0KGJvb3N0KVxuICApXG4gIHNvY2tldC5vbigncmVtb3ZlQm9vc3QnLCAoYm9vc3QpIC0+XG4gICAgY29uc29sZS5sb2coJ2Jvb3N0Jyxib29zdClcbiAgICByZW1vdmVfYm9vc3QoYm9vc3QpXG4gIClcblxuICAkKCdodG1sJykua2V5ZG93biggKGV2ZW50T2JqZWN0KSAtPlxuICAgIG5vd19kaXJlY3QgPSBteV9kaXJlY3Rpb25cbiAgICBnbyA9IG15X2dvXG4gICAgaWYgKGV2ZW50LmtleUNvZGUgPT0gMzcpXG4gICAgICAgIGNvbnNvbGUubG9nKFwi0KPRgNCwINC90LDQttCw0LvQuCBsZWZ0XCIpXG4gICAgICAgIG5vd19kaXJlY3QgPSAnbGVmdCdcblxuICAgIGlmIChldmVudC5rZXlDb2RlID09IDM4KVxuICAgICAgICBjb25zb2xlLmxvZyhcItCj0YDQsCDQvdCw0LbQsNC70LggdXBcIilcbiAgICAgICAgbm93X2RpcmVjdCA9ICd1cCdcblxuICAgIGlmIChldmVudC5rZXlDb2RlID09IDM5KVxuICAgICAgICBjb25zb2xlLmxvZyhcItCj0YDQsCDQvdCw0LbQsNC70LggcmlnaHRcIik7XG4gICAgICAgIG5vd19kaXJlY3QgPSAncmlnaHQnXG5cbiAgICBpZiAoZXZlbnQua2V5Q29kZSA9PSA0MClcbiAgICAgICAgY29uc29sZS5sb2coXCLQo9GA0LAg0L3QsNC20LDQu9C4IGRvd25cIik7XG4gICAgICAgIG5vd19kaXJlY3QgPSAnZG93bidcblxuICAgIGlmIChldmVudC5rZXlDb2RlID09IDgxKVxuICAgICAgICBjb25zb2xlLmxvZygn0KPRgNCwINC90LDQttCw0LvQuCDQs9C+Jyk7XG4gICAgICAgIGdvID0gZmFsc2U7XG5cbiAgICBpZiAoZXZlbnQua2V5Q29kZSA9PSA4NylcbiAgICAgICAgY29uc29sZS5sb2coJ9Cj0YDQsCDQvdCw0LbQsNC70Lggc3RvcCcpXG4gICAgICAgIGdvID0gdHJ1ZVxuXG4gICAgc29ja2V0LmVtaXQoJ3NldERpcmVjdGlvbicsIG5vd19kaXJlY3QsIGdvKVxuICAgIClcblxuICBzb2NrZXQub24oJ3RhbmtzJywgKHRhbmtzKSAtPlxuICAjICAgLy8gY29uc29sZS5sb2codGFua3NbMV0ucGxhY2Vfb25fbWFwKTtcbiAgICBmb3IgdGFuayBpbiB0YW5rc1xuICAgICAgbW92ZV90YW5rKHRhbmspXG4gIClcblxuICBzb2NrZXQub24oJ2luZm8nLCAobG9nZykgLT5cbiAgICBjb25zb2xlLmxvZyhsb2dnKVxuICApXG5cbiAgc29ja2V0LmVtaXQoJ21hcCcsIChtYXApIC0+XG4gICAgY3JlYXRlX21hcChtYXApXG4gIClcblxuICBzb2NrZXQuZW1pdCgndGFua3MnLCAodGFua3NfanNvbikgLT5cbiAgICBmb3IgdGFuayBpbiB0YW5rc19qc29uXG4gICAgICBkcmF3X3RhbmsodGFuaylcbiAgKVxuXG5cbiAgJCgnI3N0YXJ0JykuYmluZCgnY2xpY2snLCAoKSAtPlxuICAgIGlmIG5vdCBzdGFydFxuICAgICAgY29uc29sZS5sb2coJ3N0YXJ0JylcbiAgICAgIHNvY2tldC5lbWl0KCdzdGFydCcpXG4gICAgICBzdG9wID0gZmFsc2VcbiAgKVxuXG4gICQoJyNzdG9wJykuYmluZCgnY2xpY2snLCAoKSAtPlxuICAgIGlmIG5vdCBzdG9wXG4gICAgICBjb25zb2xlLmxvZygnc3RvcCcpXG4gICAgICBzb2NrZXQuZW1pdCgnc3RvcCcpXG4gICAgICBzdGFydCA9IGZhbHNlXG4gIClcblxuIl19