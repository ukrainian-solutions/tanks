$(function() {
  var add_boost, callback, create_map, draw_tank, lock, move_tank, my_direction, my_go, my_tank, remove_boost, show_tabl_tank, start, start_game, stop;
  start = false;
  stop = true;
  my_direction = 'up';
  my_go = false;
  my_tank = false;
  lock = false;
  callback = function() {
    return lock = false;
  };
  setTimeout(callback, 3000);
  create_map = function(map) {
    var div, x, y, _i, _j, _ref, _ref1, _results;
    div = $('<div/>', {
      id: 'box',
      text: 'I am box'
    });
    _results = [];
    for (x = _i = 0, _ref = map.length - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; x = 0 <= _ref ? ++_i : --_i) {
      for (y = _j = 0, _ref1 = map[x].length; 0 <= _ref1 ? _j <= _ref1 : _j >= _ref1; y = 0 <= _ref1 ? ++_j : --_j) {
        if (map[x][y] === 0) {
          $('<div/>', {
            id: 'box',
            'class': 'box',
            'data-x': x,
            'data-y': y
          }).appendTo('body');
          continue;
        }
        if (map[x][y] === 1) {
          $('<div/>', {
            id: 'box',
            'class': 'box wall',
            'data-x': x,
            'data-y': y
          }).appendTo('body');
          continue;
        }
        if (map[x][y] === 3) {
          $('<div/>', {
            id: 'box',
            'class': 'box grass',
            'data-x': x,
            'data-y': y
          }).appendTo('body');
        }
        if (map[x][y] === 4) {
          $('<div/>', {
            id: 'box',
            'class': 'box water',
            'data-x': x,
            'data-y': y
          }).appendTo('body');
        }
      }
      _results.push($('<div/>', {
        id: 'nbox',
        'style': 'clear: both;'
      }).appendTo('body'));
    }
    return _results;
  };
  start_game = function() {
    return socket.emit('addTank', function(tank_json) {
      if (tank_json["id"] === void 0) {
        my_tank = new Tank(tank_json);
        tank_json = {
          "id": tank_json[0],
          "direction": tank_json[1],
          "is_hold": tank_json[2],
          "wait": tank_json[3],
          "bullets": tank_json[4],
          "bullets_max": tank_json[5],
          "health": tank_json[6],
          "place_on_map": tank_json[7]
        };
      }
      console.log('this is tank', tank_json);
      return draw_tank(tank_json);
    });
  };
  start_game();
  draw_tank = function(tank_json) {
    var div, x, y;
    if (tank_json["id"] === void 0) {
      tank_json = {
        "id": tank_json[0],
        "direction": tank_json[1],
        "is_hold": tank_json[2],
        "wait": tank_json[3],
        "bullets": tank_json[4],
        "bullets_max": tank_json[5],
        "health": tank_json[6],
        "place_on_map": tank_json[7]
      };
    }
    y = tank_json['place_on_map'][0];
    x = tank_json['place_on_map'][1];
    div = $('*[data-x=' + x.toString() + '][data-y=' + y.toString() + ']');
    div.attr('data-id_tank', tank_json['id']);
    div.html(tank_json['health']);
    if (tank_json['id'] === my_tank.id) {
      div.addClass('my_tank');
    } else {
      div.addClass('tank');
    }
    return div.addClass(tank_json['direction']);
  };
  move_tank = function(tank_json) {
    var tank;
    if (tank_json["id"] === void 0) {
      tank_json = {
        "id": tank_json[0],
        "direction": tank_json[1],
        "is_hold": tank_json[2],
        "wait": tank_json[3],
        "bullets": tank_json[4],
        "bullets_max": tank_json[5],
        "health": tank_json[6],
        "place_on_map": tank_json[7]
      };
    }
    tank = $('[data-id_tank=' + tank_json['id'] + ']');
    tank.html('');
    if (tank_json['id'] === my_tank.id) {
      tank.removeClass('my_tank');
    } else {
      tank.removeClass('tank');
    }
    tank.removeClass('left');
    tank.removeClass('right');
    tank.removeClass('down');
    tank.removeClass('up');
    tank.addClass('box');
    return draw_tank(tank_json);
  };
  show_tabl_tank = function(tank_json) {
    var div, tank, td_damage_inflicted, td_demage_obtained, td_health, td_id;
    tank = '#t_' + tank_json['id'];
    console.log('call show tabl_tank', tank, $(tank));
    if ($(tank).length > 0) {
      console.log('not tank tr');
      div = $('<tr/>', {
        id: tank,
        'class': 'tr_tank'
      }).appendTo('.stats');
      td_id = $('<td/>', {
        id: '_id',
        'class': 'td_tank'
      }).appendTo(div);
      td_health = $('<td/>', {
        id: 'health',
        'class': 'td_tank'
      }).appendTo(div);
      td_damage_inflicted = $('<td/>', {
        id: 'damage_inflicted',
        'class': 'td_tank'
      }).appendTo(div);
      td_demage_obtained = $('<td/>', {
        id: 'demage_obtained',
        'class': 'td_tank'
      }).appendTo(div);
    } else {
      console.log('yes tank tr');
      td_id = $(tank + ' #_id');
      td_health = $(tank + ' #health');
      td_damage_inflicted = $(tank(+' #damage_inflicted'));
      td_demage_obtained = $(tank(' #demage_obtained'));
    }
    td_id.html(tank_json['id']);
    td_health.html(tank_json['health'] > 0 ? tank_json['health'] : 0);
    td_damage_inflicted.html(tank_json['damage_inflicted'] > 0 ? tank_json['damage_inflicted'] : 0);
    return td_demage_obtained.html(tank_json['demage_obtained'] > 0 ? tank_json['demage_obtained'] : 0);
  };
  socket.on('tankDestroy', function(tank_id) {
    var tank;
    tank = $('[data-id_tank=' + tank_id + ']');
    tank.html('');
    if (tank_id === my_tank.id) {
      tank.removeClass('my_tank');
    } else {
      tank.removeClass('tank');
    }
    tank.removeClass('left');
    tank.removeClass('right');
    tank.removeClass('down');
    tank.removeClass('up');
    return tank.addClass('box');
  });
  add_boost = function(boost) {
    var div, x, y;
    y = boost[0][0];
    x = boost[0][1];
    div = $('*[data-x=' + x.toString() + '][data-y=' + y.toString() + ']');
    return div.addClass(boost[1]);
  };
  remove_boost = function(boost) {
    var div, x, y;
    y = boost[0][0];
    x = boost[0][1];
    div = $('*[data-x=' + x.toString() + '][data-y=' + y.toString() + ']');
    return div.removeClass(boost[1]);
  };
  socket.on('newBoost', function(boost) {
    console.log('boost', boost);
    return add_boost(boost);
  });
  socket.on('removeBoost', function(boost) {
    console.log('boost', boost);
    return remove_boost(boost);
  });
  $('html').keydown(function(eventObject) {
    var go, now_direct;
    now_direct = my_direction;
    go = my_go;
    if (event.keyCode === 37) {
      console.log("Ура нажали left");
      now_direct = 'left';
    }
    if (event.keyCode === 38) {
      console.log("Ура нажали up");
      now_direct = 'up';
    }
    if (event.keyCode === 39) {
      console.log("Ура нажали right");
      now_direct = 'right';
    }
    if (event.keyCode === 40) {
      console.log("Ура нажали down");
      now_direct = 'down';
    }
    if (event.keyCode === 81) {
      console.log('Ура нажали го');
      go = false;
    }
    if (event.keyCode === 87) {
      console.log('Ура нажали stop');
      go = true;
    }
    return socket.emit('setDirection', now_direct, go);
  });
  socket.on('tanks', function(tanks) {
    var tank, _i, _len, _results;
    _results = [];
    for (_i = 0, _len = tanks.length; _i < _len; _i++) {
      tank = tanks[_i];
      _results.push(move_tank(tank));
    }
    return _results;
  });
  socket.on('info', function(logg) {
    return console.log(logg);
  });
  socket.emit('map', function(map) {
    return create_map(map);
  });
  return socket.emit('tanks', function(tanks_json) {
    var tank, _i, _len, _results;
    _results = [];
    for (_i = 0, _len = tanks_json.length; _i < _len; _i++) {
      tank = tanks_json[_i];
      _results.push(draw_tank(tank));
    }
    return _results;
  });
});

//# sourceMappingURL=data:application/json;base64,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QkFGaUI7RUFBQSxDQUFuQixDQTdPQSxDQUFBO0FBQUEsRUFtUEEsTUFBTSxDQUFDLEVBQVAsQ0FBVSxNQUFWLEVBQWtCLFNBQUMsSUFBRCxHQUFBO1dBQ2hCLE9BQU8sQ0FBQyxHQUFSLENBQVksSUFBWixFQURnQjtFQUFBLENBQWxCLENBblBBLENBQUE7QUFBQSxFQXVQQSxNQUFNLENBQUMsSUFBUCxDQUFZLEtBQVosRUFBbUIsU0FBQyxHQUFELEdBQUE7V0FDakIsVUFBQSxDQUFXLEdBQVgsRUFEaUI7RUFBQSxDQUFuQixDQXZQQSxDQUFBO1NBMlBBLE1BQU0sQ0FBQyxJQUFQLENBQVksT0FBWixFQUFxQixTQUFDLFVBQUQsR0FBQTtBQUNuQixRQUFBLHdCQUFBO0FBQUE7U0FBQSxpREFBQTs0QkFBQTtBQUNFLG9CQUFBLFNBQUEsQ0FBVSxJQUFWLEVBQUEsQ0FERjtBQUFBO29CQURtQjtFQUFBLENBQXJCLEVBNVBBO0FBQUEsQ0FBRixDQUFBLENBQUEiLCJmaWxlIjoianMvbWFwX2NyZWF0ZS5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbIiQgLT5cbiAgc3RhcnQgPSBmYWxzZVxuICBzdG9wID0gdHJ1ZVxuICBteV9kaXJlY3Rpb24gPSAndXAnXG4gIG15X2dvID0gZmFsc2VcbiAgbXlfdGFuayA9IGZhbHNlXG4gIGxvY2sgPSBmYWxzZVxuICBjYWxsYmFjayA9IC0+XG4gICAgbG9jayA9IGZhbHNlXG4gIHNldFRpbWVvdXQgY2FsbGJhY2ssIDMwMDBcbiAgY3JlYXRlX21hcCA9IChtYXApIC0+XG4gICAgZGl2ID0gJCgnPGRpdi8+Jywge1xuICAgIGlkOiAnYm94JyxcbiAgICB0ZXh0OiAnSSBhbSBib3gnXG4gICAgfSlcbiAgICBmb3IgeCBpbiBbMC4ubWFwLmxlbmd0aC0xXVxuICAgICAgZm9yIHkgaW4gWzAuLm1hcFt4XS5sZW5ndGhdXG4gICAgICAgIGlmIG1hcFt4XVt5XSA9PSAwXG4gICAgICAgICAgJCgnPGRpdi8+Jywge1xuICAgICAgICAgICAgaWQ6ICdib3gnLFxuICAgICAgICAgICAgJ2NsYXNzJzogJ2JveCcsXG4gICAgICAgICAgICAnZGF0YS14JzogeCxcbiAgICAgICAgICAgICdkYXRhLXknOiB5XG4gICAgICAgICAgfSkuYXBwZW5kVG8gJ2JvZHknXG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgaWYobWFwW3hdW3ldID09IDEpXG4gICAgICAgICAgJCgnPGRpdi8+Jywge1xuICAgICAgICAgICAgaWQ6ICdib3gnLFxuICAgICAgICAgICAgJ2NsYXNzJzogJ2JveCB3YWxsJyxcbiAgICAgICAgICAgICdkYXRhLXgnOiB4LFxuICAgICAgICAgICAgJ2RhdGEteSc6IHlcbiAgICAgICAgICB9KS5hcHBlbmRUbygnYm9keScpXG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgaWYobWFwW3hdW3ldID09IDMpXG4gICAgICAgICAgJCgnPGRpdi8+Jywge1xuICAgICAgICAgICAgaWQ6ICdib3gnLFxuICAgICAgICAgICAgJ2NsYXNzJzogJ2JveCBncmFzcycsXG4gICAgICAgICAgICAnZGF0YS14JzogeCxcbiAgICAgICAgICAgICdkYXRhLXknOiB5XG4gICAgICAgICAgfSkuYXBwZW5kVG8gJ2JvZHknXG5cbiAgICAgICAgaWYobWFwW3hdW3ldID09IDQpXG4gICAgICAgICAgJCgnPGRpdi8+Jywge1xuICAgICAgICAgICAgaWQ6ICdib3gnLFxuICAgICAgICAgICAgJ2NsYXNzJzogJ2JveCB3YXRlcicsXG4gICAgICAgICAgICAnZGF0YS14JzogeCxcbiAgICAgICAgICAgICdkYXRhLXknOiB5XG4gICAgICAgICAgfSkuYXBwZW5kVG8gJ2JvZHknXG4gICAgICAkKCc8ZGl2Lz4nLCB7XG4gICAgICAgIGlkOiAnbmJveCcsXG4gICAgICAgICdzdHlsZSc6ICdjbGVhcjogYm90aDsnXG4gICAgICB9KS5hcHBlbmRUbyAnYm9keSdcblxuICBzdGFydF9nYW1lID0gICgpLT5cbiAgICBzb2NrZXQuZW1pdCgnYWRkVGFuaycsICh0YW5rX2pzb24pIC0+XG4gICAgICBpZiB0YW5rX2pzb25bXCJpZFwiXSA9PSB1bmRlZmluZWRcbiAgICAgICAgbXlfdGFuayA9IG5ldyBUYW5rKHRhbmtfanNvbilcbiAgICAgICAgdGFua19qc29uID1cbiAgICAgICAgICBcImlkXCI6IHRhbmtfanNvblswXSxcbiAgICAgICAgICBcImRpcmVjdGlvblwiOiB0YW5rX2pzb25bMV0sXG4gICAgICAgICAgXCJpc19ob2xkXCI6IHRhbmtfanNvblsyXSxcbiAgICAgICAgICBcIndhaXRcIjogdGFua19qc29uWzNdLFxuICAgICAgICAgIFwiYnVsbGV0c1wiOiB0YW5rX2pzb25bNF0sXG4gICAgICAgICAgXCJidWxsZXRzX21heFwiOiB0YW5rX2pzb25bNV0sXG4gICAgICAgICAgXCJoZWFsdGhcIjogdGFua19qc29uWzZdLFxuICAgICAgICAgIFwicGxhY2Vfb25fbWFwXCI6IHRhbmtfanNvbls3XVxuXG4gICAgICBjb25zb2xlLmxvZygndGhpcyBpcyB0YW5rJywgdGFua19qc29uKTtcbiAgICAgIGRyYXdfdGFuayh0YW5rX2pzb24pXG4gICAgICApXG5cbiAgc3RhcnRfZ2FtZSgpXG5cbiAgZHJhd190YW5rID0gKHRhbmtfanNvbikgLT5cbiAgICAjIHJldHVybiBbQGlkLCBAZGlyZWN0aW9uLCBAaXNfaG9sZCwgQHdhaXQsIEBidWxsZXRzLCBAYnVsbGV0c19tYXgsIEBoZWFsdGgsIEBwbGFjZV9vbl9tYXBdXG4gICAgaWYodGFua19qc29uW1wiaWRcIl0gPT0gdW5kZWZpbmVkKVxuICAgICAgdGFua19qc29uID1cbiAgICAgICAgXCJpZFwiOiB0YW5rX2pzb25bMF0sXG4gICAgICAgIFwiZGlyZWN0aW9uXCI6IHRhbmtfanNvblsxXSxcbiAgICAgICAgXCJpc19ob2xkXCI6IHRhbmtfanNvblsyXSxcbiAgICAgICAgXCJ3YWl0XCI6IHRhbmtfanNvblszXSxcbiAgICAgICAgXCJidWxsZXRzXCI6IHRhbmtfanNvbls0XSxcbiAgICAgICAgXCJidWxsZXRzX21heFwiOiB0YW5rX2pzb25bNV0sXG4gICAgICAgIFwiaGVhbHRoXCI6IHRhbmtfanNvbls2XSxcbiAgICAgICAgXCJwbGFjZV9vbl9tYXBcIjogdGFua19qc29uWzddXG5cbiAgICB5ID0gdGFua19qc29uWydwbGFjZV9vbl9tYXAnXVswXVxuICAgIHggPSB0YW5rX2pzb25bJ3BsYWNlX29uX21hcCddWzFdXG4gICAgZGl2ID0gJCgnKltkYXRhLXg9Jyt4LnRvU3RyaW5nKCkrJ11bZGF0YS15PScrIHkudG9TdHJpbmcoKSsnXScpXG4gICAgZGl2LmF0dHIoJ2RhdGEtaWRfdGFuaycsIHRhbmtfanNvblsnaWQnXSlcbiAgICBkaXYuaHRtbCh0YW5rX2pzb25bJ2hlYWx0aCddKVxuICAgIGlmKHRhbmtfanNvblsnaWQnXSA9PSBteV90YW5rLmlkKVxuICAgICAgICBkaXYuYWRkQ2xhc3MoJ215X3RhbmsnKVxuICAgIGVsc2VcbiAgICAgICAgZGl2LmFkZENsYXNzKCd0YW5rJylcbiAgICBkaXYuYWRkQ2xhc3ModGFua19qc29uWydkaXJlY3Rpb24nXSlcblxuICBtb3ZlX3RhbmsgPSAodGFua19qc29uKSAtPlxuICAgICMvLyB0b0pzb246IC0+IFtAaWRcbiAgICAjICAgICAgICAgICAgLy8gQGRpcmVjdGlvblxuICAgICMgICAgICAgICAgICAvLyBAaXNfaG9sZFxuICAgICMgICAgICAgICAgICAvLyBAd2FpdFxuICAgICMgICAgICAgICAgICAvLyBAYnVsbGV0c1xuICAgICMgICAgICAgICAgICAvLyBAYnVsbGV0c19tYXhcbiAgICAjICAgICAgICAgICAgLy8gQGhlYWx0aFxuICAgICMgICAgICAgICAgICAvLyBAcGxhY2Vfb25fbWFwXG4gICAgIyAgICAgICAgICAgIC8vIEBkYW1hZ2VfaW5mbGljdGVkXG4gICAgIyAgICAgICAgICAgIC8vIEBkZW1hZ2Vfb2J0YWluZWRcbiAgICAjICAgICAgICAgICAgLy8gQGRlc3Ryb3llZF1cbiAgICBpZih0YW5rX2pzb25bXCJpZFwiXSA9PSB1bmRlZmluZWQpXG4gICAgICB0YW5rX2pzb24gPVxuICAgICAgICBcImlkXCI6IHRhbmtfanNvblswXSxcbiAgICAgICAgXCJkaXJlY3Rpb25cIjogdGFua19qc29uWzFdLFxuICAgICAgICBcImlzX2hvbGRcIjogdGFua19qc29uWzJdLFxuICAgICAgICBcIndhaXRcIjogdGFua19qc29uWzNdLFxuICAgICAgICBcImJ1bGxldHNcIjogdGFua19qc29uWzRdLFxuICAgICAgICBcImJ1bGxldHNfbWF4XCI6IHRhbmtfanNvbls1XSxcbiAgICAgICAgXCJoZWFsdGhcIjogdGFua19qc29uWzZdLFxuICAgICAgICBcInBsYWNlX29uX21hcFwiOiB0YW5rX2pzb25bN11cbiAgICB0YW5rID0gJCgnW2RhdGEtaWRfdGFuaz0nK3RhbmtfanNvblsnaWQnXSsnXScpXG4gICAgdGFuay5odG1sKCcnKVxuICAgIGlmIHRhbmtfanNvblsnaWQnXSA9PSBteV90YW5rLmlkXG4gICAgICAgIHRhbmsucmVtb3ZlQ2xhc3MoJ215X3RhbmsnKVxuICAgIGVsc2VcbiAgICAgICAgdGFuay5yZW1vdmVDbGFzcygndGFuaycpXG4gICAgdGFuay5yZW1vdmVDbGFzcygnbGVmdCcpXG4gICAgdGFuay5yZW1vdmVDbGFzcygncmlnaHQnKVxuICAgIHRhbmsucmVtb3ZlQ2xhc3MoJ2Rvd24nKVxuICAgIHRhbmsucmVtb3ZlQ2xhc3MoJ3VwJylcbiAgICB0YW5rLmFkZENsYXNzKCdib3gnKVxuICAgIGRyYXdfdGFuayh0YW5rX2pzb24pXG5cbiAgc2hvd190YWJsX3RhbmsgPSAodGFua19qc29uKSAtPlxuICAgIHRhbmsgPSAnI3RfJyt0YW5rX2pzb25bJ2lkJ11cbiAgICBjb25zb2xlLmxvZygnY2FsbCBzaG93IHRhYmxfdGFuaycsIHRhbmssICQodGFuaykpXG4gICAgaWYgJCh0YW5rKS5sZW5ndGggPiAwXG4gICAgICBjb25zb2xlLmxvZygnbm90IHRhbmsgdHInKVxuICAgICAgZGl2ID0gJCgnPHRyLz4nLCB7XG4gICAgICAgIGlkOiB0YW5rLFxuICAgICAgICAnY2xhc3MnOiAndHJfdGFuaycsXG4gICAgICB9KS5hcHBlbmRUbyAnLnN0YXRzJ1xuICAgICAgdGRfaWQgPSAkKCc8dGQvPicsIHtcbiAgICAgICAgaWQ6ICdfaWQnLFxuICAgICAgICAnY2xhc3MnOiAndGRfdGFuaycsXG4gICAgICB9KS5hcHBlbmRUbyBkaXZcbiAgICAgIHRkX2hlYWx0aCA9ICQoJzx0ZC8+Jywge1xuICAgICAgICBpZDogJ2hlYWx0aCcsXG4gICAgICAgICdjbGFzcyc6ICd0ZF90YW5rJyxcbiAgICAgIH0pLmFwcGVuZFRvIGRpdlxuICAgICAgdGRfZGFtYWdlX2luZmxpY3RlZCA9ICQoJzx0ZC8+Jywge1xuICAgICAgICBpZDogJ2RhbWFnZV9pbmZsaWN0ZWQnLFxuICAgICAgICAnY2xhc3MnOiAndGRfdGFuaycsXG4gICAgICB9KS5hcHBlbmRUbyBkaXZcbiAgICAgIHRkX2RlbWFnZV9vYnRhaW5lZCA9ICQoJzx0ZC8+Jywge1xuICAgICAgICBpZDogJ2RlbWFnZV9vYnRhaW5lZCcsXG4gICAgICAgICdjbGFzcyc6ICd0ZF90YW5rJyxcbiAgICAgIH0pLmFwcGVuZFRvIGRpdlxuXG4gICAgZWxzZVxuICAgICAgY29uc29sZS5sb2cgJ3llcyB0YW5rIHRyJ1xuICAgICAgdGRfaWQgPSAkKHRhbmsrJyAjX2lkJylcbiAgICAgIHRkX2hlYWx0aCA9ICQodGFuaysnICNoZWFsdGgnKVxuICAgICAgdGRfZGFtYWdlX2luZmxpY3RlZCA9ICQodGFuayArJyAjZGFtYWdlX2luZmxpY3RlZCcpXG4gICAgICB0ZF9kZW1hZ2Vfb2J0YWluZWQgPSAkKHRhbmsgJyAjZGVtYWdlX29idGFpbmVkJylcblxuICAgIHRkX2lkLmh0bWwodGFua19qc29uWydpZCddKVxuICAgIHRkX2hlYWx0aC5odG1sKGlmIHRhbmtfanNvblsnaGVhbHRoJ10gPiAwIHRoZW4gdGFua19qc29uWydoZWFsdGgnXSBlbHNlIDApXG4gICAgdGRfZGFtYWdlX2luZmxpY3RlZC5odG1sKGlmIHRhbmtfanNvblsnZGFtYWdlX2luZmxpY3RlZCddID4gMCB0aGVuIHRhbmtfanNvblsnZGFtYWdlX2luZmxpY3RlZCddIGVsc2UgMClcbiAgICB0ZF9kZW1hZ2Vfb2J0YWluZWQuaHRtbChpZiB0YW5rX2pzb25bJ2RlbWFnZV9vYnRhaW5lZCddID4gMCB0aGVuIHRhbmtfanNvblsnZGVtYWdlX29idGFpbmVkJ10gIGVsc2UgMClcblxuXG4gIHNvY2tldC5vbigndGFua0Rlc3Ryb3knLCAodGFua19pZCkgLT5cbiAgICB0YW5rID0gJCgnW2RhdGEtaWRfdGFuaz0nK3RhbmtfaWQrJ10nKVxuICAgIHRhbmsuaHRtbCgnJylcbiAgICBpZiB0YW5rX2lkID09IG15X3RhbmsuaWRcbiAgICAgICAgdGFuay5yZW1vdmVDbGFzcygnbXlfdGFuaycpXG4gICAgZWxzZVxuICAgICAgICB0YW5rLnJlbW92ZUNsYXNzKCd0YW5rJylcbiAgICB0YW5rLnJlbW92ZUNsYXNzKCdsZWZ0JylcbiAgICB0YW5rLnJlbW92ZUNsYXNzKCdyaWdodCcpXG4gICAgdGFuay5yZW1vdmVDbGFzcygnZG93bicpXG4gICAgdGFuay5yZW1vdmVDbGFzcygndXAnKVxuICAgIHRhbmsuYWRkQ2xhc3MoJ2JveCcpXG4gIClcblxuICBhZGRfYm9vc3QgPSAoYm9vc3QpIC0+XG4gICAgeSA9IGJvb3N0WzBdWzBdXG4gICAgeCA9IGJvb3N0WzBdWzFdXG5cbiAgICBkaXYgPSAkKCcqW2RhdGEteD0nK3gudG9TdHJpbmcoKSsnXVtkYXRhLXk9JysgeS50b1N0cmluZygpKyddJylcbiAgICBkaXYuYWRkQ2xhc3MoYm9vc3RbMV0pXG5cbiAgcmVtb3ZlX2Jvb3N0ID0gKGJvb3N0KSAtPlxuICAgIHkgPSBib29zdFswXVswXVxuICAgIHggPSBib29zdFswXVsxXVxuXG4gICAgZGl2ID0gJCgnKltkYXRhLXg9Jyt4LnRvU3RyaW5nKCkrJ11bZGF0YS15PScrIHkudG9TdHJpbmcoKSsnXScpXG4gICAgZGl2LnJlbW92ZUNsYXNzKGJvb3N0WzFdKVxuXG4gIHNvY2tldC5vbignbmV3Qm9vc3QnLCAoYm9vc3QpIC0+XG4gICAgY29uc29sZS5sb2coJ2Jvb3N0Jyxib29zdClcbiAgICBhZGRfYm9vc3QoYm9vc3QpXG4gIClcbiAgc29ja2V0Lm9uKCdyZW1vdmVCb29zdCcsIChib29zdCkgLT5cbiAgICBjb25zb2xlLmxvZygnYm9vc3QnLGJvb3N0KVxuICAgIHJlbW92ZV9ib29zdChib29zdClcbiAgKVxuXG4gICQoJ2h0bWwnKS5rZXlkb3duKCAoZXZlbnRPYmplY3QpIC0+XG4gICAgbm93X2RpcmVjdCA9IG15X2RpcmVjdGlvblxuICAgIGdvID0gbXlfZ29cbiAgICBpZiAoZXZlbnQua2V5Q29kZSA9PSAzNylcbiAgICAgICAgY29uc29sZS5sb2coXCLQo9GA0LAg0L3QsNC20LDQu9C4IGxlZnRcIilcbiAgICAgICAgbm93X2RpcmVjdCA9ICdsZWZ0J1xuXG4gICAgaWYgKGV2ZW50LmtleUNvZGUgPT0gMzgpXG4gICAgICAgIGNvbnNvbGUubG9nKFwi0KPRgNCwINC90LDQttCw0LvQuCB1cFwiKVxuICAgICAgICBub3dfZGlyZWN0ID0gJ3VwJ1xuXG4gICAgaWYgKGV2ZW50LmtleUNvZGUgPT0gMzkpXG4gICAgICAgIGNvbnNvbGUubG9nKFwi0KPRgNCwINC90LDQttCw0LvQuCByaWdodFwiKTtcbiAgICAgICAgbm93X2RpcmVjdCA9ICdyaWdodCdcblxuICAgIGlmIChldmVudC5rZXlDb2RlID09IDQwKVxuICAgICAgICBjb25zb2xlLmxvZyhcItCj0YDQsCDQvdCw0LbQsNC70LggZG93blwiKTtcbiAgICAgICAgbm93X2RpcmVjdCA9ICdkb3duJ1xuXG4gICAgaWYgKGV2ZW50LmtleUNvZGUgPT0gODEpXG4gICAgICAgIGNvbnNvbGUubG9nKCfQo9GA0LAg0L3QsNC20LDQu9C4INCz0L4nKTtcbiAgICAgICAgZ28gPSBmYWxzZTtcblxuICAgIGlmIChldmVudC5rZXlDb2RlID09IDg3KVxuICAgICAgICBjb25zb2xlLmxvZygn0KPRgNCwINC90LDQttCw0LvQuCBzdG9wJylcbiAgICAgICAgZ28gPSB0cnVlXG5cbiAgICBzb2NrZXQuZW1pdCgnc2V0RGlyZWN0aW9uJywgbm93X2RpcmVjdCwgZ28pXG4gICAgKVxuXG4gIHNvY2tldC5vbigndGFua3MnLCAodGFua3MpIC0+XG4gICMgICAvLyBjb25zb2xlLmxvZyh0YW5rc1sxXS5wbGFjZV9vbl9tYXApO1xuICAgIGZvciB0YW5rIGluIHRhbmtzXG4gICAgICBtb3ZlX3RhbmsodGFuaylcbiAgKVxuXG4gIHNvY2tldC5vbignaW5mbycsIChsb2dnKSAtPlxuICAgIGNvbnNvbGUubG9nKGxvZ2cpXG4gIClcblxuICBzb2NrZXQuZW1pdCgnbWFwJywgKG1hcCkgLT5cbiAgICBjcmVhdGVfbWFwKG1hcClcbiAgKVxuXG4gIHNvY2tldC5lbWl0KCd0YW5rcycsICh0YW5rc19qc29uKSAtPlxuICAgIGZvciB0YW5rIGluIHRhbmtzX2pzb25cbiAgICAgIGRyYXdfdGFuayh0YW5rKVxuICApXG4iXX0=