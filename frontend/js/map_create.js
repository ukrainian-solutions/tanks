$(document).ready(function() {
    var map = [[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
           [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,3,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
           [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
           [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]];
    function create_map(map) {
        var div = $('<div/>', {
        id: 'box',
        text: 'I am box'
        });
        for(var x=0; x<map.length; x++) {
            for(var y=0; y<map[x].length; y++){
                if(map[x][y] == 0) {
                    $('<div/>', {
                        id: 'box',
                        'class': 'box',
                        'data-x': x,
                        'data-y': y
                    }).appendTo('body');
                    continue;
                }
                if(map[x][y] == 1) {
                    $('<div/>', {
                        id: 'box',
                        'class': 'wall',
                        'data-x': x,
                        'data-y': y
                    }).appendTo('body');
                    continue;
                }
                if(map[x][y] == 3){
                    $('<div/>', {
                        id: 'box',
                        'class': 'grass',
                        'data-x': x,
                        'data-y': y
                    }).appendTo('body');
                }
                if(map[x][y] == 4){
                    $('<div/>', {
                        id: 'box',
                        'class': 'water',
                        'data-x': x,
                        'data-y': y
                    }).appendTo('body');
                }
            }
            $('<div/>', {
                id: 'nbox',
                'style': 'clear: both;'
            }).appendTo('body');
        }
    }
    socket.emit('map', function(map) {
        create_map(map);
    });

    function draw_tank(tank_json) {
        var x = tank_json['x'];
        var y = tank_json['y'];
        div = $('*[data-x='+x.toString()+'][data-y='+ y.toString()+']');
        div.removeClass();
        div.addClass('tank')
    }
});